# VirtualBox 連接埠轉發設定 

## NAT模式下:

+ 實體主機(Host)的IP若為「192.168.31.10」。
  > + 實際上可能有所不同，請自行取代正確IP。

+ 通常製作完的虛擬機(VM)預設會有以下設定:
  + 虛擬機被DHCP分配到一個IP，「10.0.2.15」。
  + 而實體主機扮演了閘道器與DHCP伺服器的角色，使用的IP是「10.0.2.2」。
  > + 此時NAT後的私有區域網路(區段10.0.2.x)中存在兩個可以互相溝通的IP:「10.0.2.2」、「10.0.2.15」。  
  > + 此時虛擬機(10.0.2.15)可以利用區網訪問實體主機(10.0.2.2)。
  > + 但因為安全性及其他原因，實體主機不能直接使用這個區域網路IP訪問虛擬機。
  > + 此外，虛擬機在NAT模式下將所有的對外網路流量交給實體機，對外的訪問等同於使用實體機的身分，等同於能訪問實體機的區域網路(區段192.168.31.x)。

### 小結論:
  ```
  NAT下虛擬機訪問實體主機不需要做任何設定，只要查出要用到的IP就可以使用。
  例如:
  ping 10.0.2.2
  ping 192.168.31.10
  ```
+ NAT模式下考量安全性並不提供從實體主機往虛擬機ping的方式，但提供連接埠轉發功能使實體主機可以向虛擬機透過TCP或UDP封包溝通。

+ 在連接埠轉發規則下可以做的設定中:  
  + 「名稱」可以任意訂定，只是用來識別用途。
  + 「協定」一次只能指定一個，TCP或UDP，需要同時有就寫兩個規則。
  + 「主機IP」要填寫正確擁有的IP，例如:「127.0.0.1」或「192.168.31.10」。
  + 「客體IP」要填寫正確擁有的IP，例如:「10.0.2.15」。也允許用特殊的「0.0.0.0」表示任意虛擬機IP。

+ 效果:
  + 實體主機設定「127.0.0.1」時，僅有實體主機自己可透過「127.0.0.1」訪問到虛擬機。
  + 實體主機設定「192.168.31.10」時，實體主機與同區段中的主機皆可透過「192.168.31.10」訪問到虛擬機。
  + 希望兩個同時的話就寫兩個規則。

### 小結論:
  ```
  網頁伺服器測試用設定(不必查IP資訊):
  協定:TCP
  主機IP:127.0.0.1
  主機連接埠:80
  客體IP:0.0.0.0
  客體連接埠:80
  --
  效果:只有實體主機自己訪問主機IP(127.0.0.1)等同於訪問虛擬機。
  ```
  ```
  網頁伺服器測試用設定(要查IP資訊):
  協定:TCP
  主機IP:192.168.31.10
  主機連接埠:80
  客體IP:0.0.0.0
  客體連接埠:80
  --
  效果:在同網路區段的人訪問主機IP(192.168.31.10)等同於訪問虛擬機。
  ```
